<html><head>
	<title>我的私人影视源</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}
		body { 
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			max-width: 800px; 
			margin: 0 auto; 
			padding: 20px;
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			color: #e2e8f0;
			min-height: 100vh;
		}
		.header {
			text-align: center;
			margin-bottom: 20px;
			padding: 15px;
		}
		.header h1 {
			font-size: 1.6em;
			margin-bottom: 5px;
			color: white;
			font-weight: 600;
		}
		.header p {
			font-size: 0.9em;
			color: rgba(255,255,255,0.8);
		}
		.container {
			background: rgba(255, 255, 255, 0.1);
			padding: 18px;
			border-radius: 14px;
			margin: 12px 0;
			border: 1px solid rgba(255,255,255,0.2);
			backdrop-filter: blur(15px);
		}
		.btn { 
			background: rgba(255, 255, 255, 0.2);
			color: white; 
			padding: 8px 20px; 
			border: 1px solid rgba(255,255,255,0.3);
			border-radius: 18px; 
			cursor: pointer;
			font-size: 13px;
			font-weight: 500;
			transition: all 0.3s;
			display: block;
			width: 160px;
			margin: 10px auto;
			backdrop-filter: blur(10px);
		}
		.btn:hover {
			background: rgba(255, 255, 255, 0.3);
		}
		.url-box {
			background: rgba(255, 255, 255, 0.1);
			padding: 12px;
			border-radius: 10px;
			margin: 12px 0;
			text-align: center;
			border: 1px solid rgba(255,255,255,0.2);
		}
		.url {
			font-family: 'Courier New', monospace;
			font-size: 13px;
			color: white;
			word-break: break-all;
			margin: 8px 0;
			padding: 6px;
			background: rgba(255,255,255,0.1);
			border-radius: 6px;
			border: 1px solid rgba(255,255,255,0.2);
		}
		.step {
			background: rgba(255, 255, 255, 0.1);
			padding: 10px 12px;
			border-radius: 8px;
			margin: 6px 0;
			display: flex;
			align-items: center;
			transition: all 0.2s;
			border: 1px solid rgba(255,255,255,0.1);
		}
		.step:hover {
			background: rgba(255, 255, 255, 0.15);
		}
		.step-number {
			background: rgba(255, 255, 255, 0.2);
			color: white;
			width: 22px;
			height: 22px;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			margin-right: 10px;
			font-weight: 600;
			font-size: 11px;
			flex-shrink: 0;
			border: 1px solid rgba(255,255,255,0.3);
		}
		.step-content {
			flex: 1;
			font-size: 13px;
			color: white;
		}
		.feature-grid {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 8px;
			margin: 12px 0;
		}
		.feature {
			background: rgba(255, 255, 255, 0.1);
			padding: 12px;
			border-radius: 8px;
			text-align: center;
			transition: all 0.3s;
			border: 1px solid rgba(255,255,255,0.1);
		}
		.feature:hover {
			background: rgba(255, 255, 255, 0.15);
		}
		.feature-icon {
			font-size: 1.3em;
			margin-bottom: 6px;
			display: block;
		}
		.feature h4 {
			margin: 4px 0 2px 0;
			font-size: 12px;
			font-weight: 600;
			color: white;
		}
		.feature p {
			font-size: 11px;
			color: rgba(255,255,255,0.8);
			margin: 0;
		}
		.device-status {
			background: rgba(255, 255, 255, 0.1);
			border: 1px solid rgba(255,255,255,0.2);
			padding: 10px;
			border-radius: 8px;
			margin: 10px 0;
			text-align: center;
		}
		.device-status .icon {
			font-size: 1.3em;
			margin-bottom: 4px;
			display: block;
		}
		.device-info {
			background: rgba(255, 255, 255, 0.1);
			padding: 8px;
			border-radius: 6px;
			margin: 10px 0;
			font-size: 11px;
			text-align: center;
			color: rgba(255,255,255,0.9);
			border: 1px solid rgba(255,255,255,0.2);
		}
		.tips {
			background: rgba(255, 255, 255, 0.1);
			padding: 12px;
			border-radius: 8px;
			margin: 12px 0;
			border: 1px solid rgba(255,255,255,0.2);
		}
		.tip-item {
			margin: 4px 0;
			padding-left: 10px;
			position: relative;
			font-size: 12px;
			color: rgba(255,255,255,0.9);
		}
		.tip-item:before {
			content: "•";
			position: absolute;
			left: 0;
			color: rgba(255,255,255,0.8);
			font-weight: bold;
		}
		.footer {
			text-align: center;
			margin-top: 15px;
			padding-top: 12px;
			border-top: 1px solid rgba(255,255,255,0.2);
			font-size: 11px;
			color: rgba(255,255,255,0.7);
		}
		h3 {
			color: white;
			margin-bottom: 12px;
			font-size: 1em;
			font-weight: 600;
			text-align: center;
		}
	</style>
</head>
<body>
	<div class="header">
		<h1>🎬 我的私人影视源</h1>
		<p>同一网址，智能识别客户端类型</p>
	</div>

	<!-- 使用教程 -->
	<div class="container">
		<h3>📖 使用教程</h3>
		
		<div class="step">
			<div class="step-number">1</div>
			<div class="step-content">复制下方智能服务地址</div>
		</div>
		
		<div class="url-box">
			<div class="url" id="serviceUrl">http://127.0.0.1:8080</div>
			<button class="btn" onclick="copyServiceUrl()">📋 复制服务地址</button>
		</div>
		
		<div class="step">
			<div class="step-number">2</div>
			<div class="step-content">打开 TVBOX 或 FongMi 应用</div>
		</div>
		
		<div class="step">
			<div class="step-number">3</div>
			<div class="step-content">在配置地址中粘贴此网址</div>
		</div>
		
		<div class="step">
			<div class="step-number">4</div>
			<div class="step-content">点击确定开始使用</div>
		</div>
	</div>

	<!-- 设备检测 -->
	<div class="container">
		<h3>🔍 设备检测</h3>
		<div class="device-status">
			<span class="icon">🌐</span>
			<strong>当前访问模式：浏览器</strong>
			<p style="margin: 3px 0 0 0; font-size: 11px; color: rgba(255,255,255,0.8);">显示引导页面</p>
		</div>
		<div class="device-info">
			智能识别：自动检测 TVBOX、FongMi、影视仓等客户端
		</div>
	</div>

	<!-- 服务特点 -->
	<div class="container">
		<h3>✨ 服务特点</h3>
		<div class="feature-grid">
			<div class="feature">
				<span class="feature-icon">🌐</span>
				<h4>浏览器访问</h4>
				<p>显示引导页面</p>
			</div>
			<div class="feature">
				<span class="feature-icon">📱</span>
				<h4>TVBOX访问</h4>
				<p>返回JSON数据</p>
			</div>
			<div class="feature">
				<span class="feature-icon">⚡</span>
				<h4>智能识别</h4>
				<p>自动设备检测</p>
			</div>
			<div class="feature">
				<span class="feature-icon">🔒</span>
				<h4>自动跳转</h4>
				<p>无需手动操作</p>
			</div>
		</div>
	</div>

	<!-- 温馨提示 -->
	<div class="container tips">
		<h3>💡 温馨提示</h3>
		<div class="tip-item">智能识别：浏览器显示页面，TVBOX返回数据</div>
		<div class="tip-item">请将本地址配置到TVBOX的数据源设置中</div>
		<div class="tip-item">如遇无法播放，请尝试切换视频源</div>
		<div class="tip-item">请勿相信视频中的任何付费广告</div>
	</div>

	<div class="footer">
		TVBOX、FongMi 智能解析影视源 © 2025
	</div>
<script>
    // 自动生成网址
    const baseUrl = window.location.origin + window.location.pathname.replace(/\/[^\/]*$/, '');
    const serviceUrl = baseUrl;
    
    document.getElementById('serviceUrl').textContent = serviceUrl;
    
    // 增强版 TVBOX 检测函数
    function isTVBoxUserAgent() {
        const ua = navigator.userAgent.toLowerCase();
        const tvboxKeywords = [
            'tvbox', 'okhttp', 'catvod', 'tang', '影视仓',
            'p2p', 'player', 'video', 'tv.apk', 'tv/',
            'android.tv', 'smarttv', 'tvos', 'fongmi',
            'android', 'mobile'  // 添加更多移动端标识
        ];
        
        // 检查是否是 TVBOX 相关应用
        const isTVBoxApp = tvboxKeywords.some(keyword => ua.includes(keyword));
        
        // 额外检查：如果是直接访问根路径，可能是 TVBOX
        const isRootPath = window.location.pathname === '/' || 
                          window.location.pathname === '/my-tvbox-source/' ||
                          !window.location.pathname.includes('.html');
        
        return isTVBoxApp || isTVBoxDirectAccess();
    }
    
    // 检测是否为 TVBOX 直接访问（无 User-Agent 特征时）
    function isTVBoxDirectAccess() {
        // 检查 URL 参数、referrer 等
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.has('tvbox') || 
               urlParams.has('player') ||
               document.referrer.includes('tvbox');
    }
    
    // 复制功能
    function copyServiceUrl() {
        const url = document.getElementById('serviceUrl').textContent;
        navigator.clipboard.writeText(url).then(() => {
            alert('✅ 服务地址复制成功！\n请到TVBOX配置中粘贴使用');
        }).catch(() => {
            // 降级方案
            const textArea = document.createElement('textarea');
            textArea.value = url;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            alert('✅ 服务地址复制成功！');
        });
    }
    
    // 如果是TVBOX访问，立即重定向到JSON数据
    if (isTVBoxUserAgent()) {
        console.log('检测到TVBOX访问，重定向到 data.json');
        window.location.href = baseUrl + '/data.json';
    } else {
        console.log('浏览器访问，显示引导页面');
    }
</script>

</body></html>