<!DOCTYPE html>
<html>
<head>
	<title>FongMi - æ™ºèƒ½è§£ææœåŠ¡</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<!-- TVBOX é‡å®šå‘ -->
	<script>
		// ç«‹å³æ£€æµ‹å¹¶é‡å®šå‘
		(function() {
			const ua = navigator.userAgent.toLowerCase();
			const isTVBox = ua.includes('okhttp') || ua.includes('tvbox') || 
							ua.includes('catvod') || ua.includes('å½±è§†ä»“') ||
							ua.includes('androlua') || ua.includes('fongmi');
			
			// æ£€æŸ¥URLå‚æ•°
			const urlParams = new URLSearchParams(window.location.search);
			const hasTvBoxParam = urlParams.get('tvbox') || urlParams.get('catvod');
			
			if (isTVBox || hasTvBoxParam) {
				console.log('TVBOX è®¿é—®æ£€æµ‹åˆ°ï¼Œé‡å®šå‘åˆ° data.json');
				// ä½¿ç”¨replaceé¿å…å›é€€åˆ°å½“å‰é¡µ
				window.location.replace('./data.json');
			}
		})();
	</script>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}
		body { 
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			max-width: 800px; 
			margin: 0 auto; 
			padding: 20px;
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			color: #e2e8f0;
			min-height: 100vh;
		}
		.header {
			text-align: center;
			margin-bottom: 20px;
			padding: 15px;
		}
		.header h1 {
			font-size: 1.6em;
			margin-bottom: 5px;
			color: white;
			font-weight: 600;
		}
		.header p {
			font-size: 0.9em;
			color: rgba(255,255,255,0.8);
		}
		.container {
			background: rgba(255, 255, 255, 0.1);
			padding: 18px;
			border-radius: 14px;
			margin: 12px 0;
			border: 1px solid rgba(255,255,255,0.2);
			backdrop-filter: blur(15px);
		}
		.url-box {
			background: rgba(255, 255, 255, 0.1);
			padding: 12px;
			border-radius: 10px;
			margin: 12px 0;
			text-align: center;
			border: 1px solid rgba(255,255,255,0.2);
		}
		.url-section {
			margin-bottom: 15px;
		}
		.url-label {
			font-size: 12px;
			color: rgba(255,255,255,0.9);
			margin-bottom: 5px;
			display: block;
		}
		.url {
			font-family: 'Courier New', monospace;
			font-size: 13px;
			color: white;
			word-break: break-all;
			margin: 8px 0;
			padding: 6px;
			background: rgba(255,255,255,0.1);
			border-radius: 6px;
			border: 1px solid rgba(255,255,255,0.2);
			cursor: pointer;
			transition: all 0.3s;
			position: relative;
		}
		.url:hover {
			background: rgba(255,255,255,0.15);
		}
		/* å¤åˆ¶æˆåŠŸçŠ¶æ€ */
		.url.copied::after {
			content: "å¤åˆ¶æˆåŠŸ";
			position: absolute;
			right: 8px;
			top: 50%;
			transform: translateY(-50%);
			font-size: 10px;
			color: white;
			background: rgba(34, 197, 94, 0.6);
			padding: 2px 6px;
			border-radius: 4px;
		}
		.step {
			background: rgba(255, 255, 255, 0.1);
			padding: 10px 12px;
			border-radius: 8px;
			margin: 6px 0;
			display: flex;
			align-items: center;
			transition: all 0.2s;
			border: 1px solid rgba(255,255,255,0.1);
		}
		.step:hover {
			background: rgba(255, 255, 255, 0.15);
		}
		.step-number {
			background: rgba(255, 255, 255, 0.2);
			color: white;
			width: 22px;
			height: 22px;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			margin-right: 10px;
			font-weight: 600;
			font-size: 11px;
			flex-shrink: 0;
			border: 1px solid rgba(255,255,255,0.3);
		}
		.step-content {
			flex: 1;
			font-size: 13px;
			color: white;
		}
		.download-grid {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 12px;
			margin: 12px 0;
		}
		.download-item {
			background: rgba(255, 255, 255, 0.08);
			padding: 15px;
			border-radius: 10px;
			text-align: center;
			border: 1px solid rgba(255,255,255,0.1);
			transition: all 0.3s;
			cursor: pointer;
			position: relative;
		}
		.download-item:hover {
			background: rgba(255, 255, 255, 0.12);
			transform: translateY(-2px);
		}
		/* ä¸‹è½½ä¸­çŠ¶æ€ */
		.download-item.downloading::after {
			content: "ä¸‹è½½ä¸­...";
			position: absolute;
			top: 8px;
			right: 8px;
			font-size: 10px;
			color: white;
			background: rgba(59, 130, 246, 0.6);
			padding: 2px 6px;
			border-radius: 4px;
		}
		.download-icon {
			font-size: 1.8em;
			margin-bottom: 8px;
			display: block;
		}
		.download-item h4 {
			margin: 4px 0 6px 0;
			font-size: 14px;
			font-weight: 600;
			color: white;
		}
		.download-desc {
			font-size: 11px;
			color: rgba(255,255,255,0.8);
			line-height: 1.3;
		}
		.device-status {
			background: rgba(255, 255, 255, 0.1);
			border: 1px solid rgba(255,255,255,0.2);
			padding: 12px;
			border-radius: 8px;
			margin: 10px 0;
			text-align: center;
		}
		.device-status .icon {
			font-size: 1.5em;
			margin-bottom: 6px;
			display: block;
		}
		.device-info {
			background: rgba(255, 255, 255, 0.1);
			padding: 8px;
			border-radius: 6px;
			margin: 10px 0;
			font-size: 11px;
			text-align: center;
			color: rgba(255,255,255,0.9);
			border: 1px solid rgba(255,255,255,0.2);
		}
		.tips {
			background: rgba(255, 255, 255, 0.1);
			padding: 12px;
			border-radius: 8px;
			margin: 12px 0;
			border: 1px solid rgba(255,255,255,0.2);
		}
		.tip-item {
			margin: 4px 0;
			padding-left: 10px;
			position: relative;
			font-size: 12px;
			color: rgba(255,255,255,0.9);
		}
		.tip-item:before {
			content: "â€¢";
			position: absolute;
			left: 0;
			color: rgba(255,255,255,0.8);
			font-weight: bold;
		}
		.footer {
			text-align: center;
			margin-top: 15px;
			padding-top: 12px;
			border-top: 1px solid rgba(255,255,255,0.2);
			font-size: 11px;
			color: rgba(255,255,255,0.7);
		}
		h3 {
			color: white;
			margin-bottom: 12px;
			font-size: 1em;
			font-weight: 600;
			text-align: center;
		}
		
		/* é»‘è‰²é£æ ¼Toastæç¤º */
		.toast {
			position: fixed;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			background: rgba(0, 0, 0, 0.9);
			color: white;
			padding: 14px 20px;
			border-radius: 10px;
			font-size: 13px;
			z-index: 1000;
			backdrop-filter: blur(10px);
			border: 1px solid rgba(255,255,255,0.2);
			box-shadow: 0 8px 25px rgba(0,0,0,0.3);
			animation: toastFade 2s ease-in-out forwards;
			text-align: center;
		}
		@keyframes toastFade {
			0% { opacity: 0; transform: translate(-50%, -20px); }
			20% { opacity: 1; transform: translate(-50%, -50%); }
			80% { opacity: 1; transform: translate(-50%, -50%); }
			100% { opacity: 0; transform: translate(-50%, -80px); }
		}
		
		.test-links {
			text-align: center;
			margin: 10px 0;
		}
		.test-link {
			color: rgba(255,255,255,0.8);
			font-size: 11px;
			text-decoration: none;
			margin: 0 5px;
			padding: 2px 6px;
			border: 1px solid rgba(255,255,255,0.3);
			border-radius: 4px;
			transition: all 0.3s;
		}
		.test-link:hover {
			background: rgba(255,255,255,0.1);
			color: white;
		}
		.status-info {
			font-size: 11px;
			color: rgba(255,255,255,0.8);
			margin-top: 4px;
		}
		.action-hint {
			font-size: 10px;
			color: rgba(255,255,255,0.6);
			text-align: center;
			margin-top: 8px;
		}
	</style>
</head>
<body>
	<div class="header">
		<h1>ğŸ¬ FongMi æ™ºèƒ½è§£ææœåŠ¡</h1>
		<p>åŒä¸€ç½‘å€ï¼Œæ™ºèƒ½è¯†åˆ«å®¢æˆ·ç«¯ç±»å‹ â€¢ æä¾›è½¯ä»¶ä¸‹è½½</p>
		<div class="test-links">
			<a href="?debug=1" class="test-link">è°ƒè¯•æ¨¡å¼</a>
			<a href="?tvbox=1" class="test-link">æ¨¡æ‹ŸTVBox</a>
			<a href="./data.json" class="test-link">ç›´æ¥æŸ¥çœ‹JSON</a>
		</div>
	</div>

	<!-- ä½¿ç”¨æ•™ç¨‹ -->
	<div class="container">
		<h3>ğŸ“– ä½¿ç”¨æ•™ç¨‹</h3>
		
		<div class="step">
			<div class="step-number">1</div>
			<div class="step-content">å¤åˆ¶ä¸‹æ–¹ä»»ä¸€åœ°å€</div>
		</div>
		
		<div class="url-box">
			<div class="url-section">
				<span class="url-label">ğŸ¯ æ™ºèƒ½åœ°å€ï¼ˆæ¨èï¼‰ï¼š</span>
				<div class="url" id="serviceUrl" onclick="copyServiceUrl(this)">åŠ è½½ä¸­...</div>
				<div class="action-hint">ç‚¹å‡»ä¸Šæ–¹é“¾æ¥å³å¯å¤åˆ¶</div>
			</div>
			
			<div class="url-section">
				<span class="url-label">ğŸ“„ ç›´æ¥æ•°æ®åœ°å€ï¼š</span>
				<div class="url" id="jsonUrl" onclick="copyJsonUrl(this)">åŠ è½½ä¸­...</div>
				<div class="action-hint">ç‚¹å‡»ä¸Šæ–¹é“¾æ¥å³å¯å¤åˆ¶</div>
			</div>
		</div>
		
		<div class="step">
			<div class="step-number">2</div>
			<div class="step-content">æ‰“å¼€ TVBOX æˆ– FongMi åº”ç”¨</div>
		</div>
		
		<div class="step">
			<div class="step-number">3</div>
			<div class="step-content">åœ¨é…ç½®åœ°å€ä¸­ç²˜è´´ç½‘å€</div>
		</div>
		
		<div class="step">
			<div class="step-number">4</div>
			<div class="step-content">ç‚¹å‡»ç¡®å®šå¼€å§‹ä½¿ç”¨</div>
		</div>
	</div>

	<!-- è½¯ä»¶ä¸‹è½½ -->
	<div class="container">
		<h3>ğŸ“¥ è½¯ä»¶ä¸‹è½½</h3>
		<div class="download-grid">
			<div class="download-item" onclick="downloadApp('fongmi', this)">
				<span class="download-icon">ğŸ“±</span>
				<h4>FongMi å®šåˆ¶ç‰ˆ</h4>
				<div class="download-desc">åŸºäºå®˜æ–¹ç‰ˆæœ¬ä¼˜åŒ–ï¼Œæ”¯æŒæ›´å¤šåŠŸèƒ½</div>
			</div>
			
			<div class="download-item" onclick="downloadApp('tvbox', this)">
				<span class="download-icon">ğŸ“º</span>
				<h4>TVBox å®šåˆ¶ç‰ˆ</h4>
				<div class="download-desc">å¤šç‰ˆæœ¬é€‚é…ï¼Œæ’­æ”¾ä½“éªŒæ›´æµç•…</div>
			</div>
		</div>
		<div class="action-hint">ç‚¹å‡»ä¸Šæ–¹å¡ç‰‡å³å¯ä¸‹è½½å¯¹åº”è½¯ä»¶</div>
	</div>

	<!-- è®¾å¤‡æ£€æµ‹ -->
	<div class="container">
		<h3>ğŸ” è®¾å¤‡æ£€æµ‹</h3>
		<div class="device-status">
			<span class="icon">ğŸŒ</span>
			<strong>å½“å‰è®¿é—®æ¨¡å¼ï¼š<span id="accessMode">æµè§ˆå™¨</span></strong>
			<div class="status-info">æ˜¾ç¤ºå¼•å¯¼é¡µé¢ â€¢ æ™ºèƒ½è¯†åˆ«å®¢æˆ·ç«¯</div>
		</div>
		<div class="device-info">
			å·²æ”¯æŒï¼šTVBOXã€FongMiã€å½±è§†ä»“ã€CatVodç­‰å®¢æˆ·ç«¯è‡ªåŠ¨è¯†åˆ«
		</div>
	</div>

	<!-- æ¸©é¦¨æç¤º -->
	<div class="container tips">
		<h3>ğŸ’¡ æ¸©é¦¨æç¤º</h3>
		<div class="tip-item">æ™ºèƒ½è¯†åˆ«ï¼šæµè§ˆå™¨æ˜¾ç¤ºé¡µé¢ï¼ŒTVBOXè¿”å›æ•°æ®</div>
		<div class="tip-item">å¦‚æ™ºèƒ½åœ°å€æ— æ•ˆï¼Œè¯·ä½¿ç”¨ç›´æ¥æ•°æ®åœ°å€</div>
		<div class="tip-item">è¯·å°†åœ°å€é…ç½®åˆ°TVBOXçš„æ•°æ®æºè®¾ç½®ä¸­</div>
		<div class="tip-item">è¯·å‹¿ç›¸ä¿¡è§†é¢‘ä¸­çš„ä»»ä½•ä»˜è´¹å¹¿å‘Š</div>
	</div>

	<div class="footer">
		FongMi æ™ºèƒ½è§£ææœåŠ¡ Â© 2024
	</div>

	<script>
		// è‡ªåŠ¨ç”Ÿæˆç½‘å€
		function getBaseUrl() {
			const path = window.location.pathname;
			const basePath = path.substring(0, path.lastIndexOf('/') + 1);
			return window.location.origin + basePath;
		}
		
		const baseUrl = getBaseUrl();
		const serviceUrl = baseUrl;
		const jsonUrl = baseUrl + 'data.json';
		
		document.getElementById('serviceUrl').textContent = serviceUrl;
		document.getElementById('jsonUrl').textContent = jsonUrl;
		
		// å¢å¼ºç‰ˆ TVBOX æ£€æµ‹å‡½æ•°
		function isTVBoxUserAgent() {
			const ua = navigator.userAgent.toLowerCase();
			
			// æ›´å…¨é¢çš„ TVBOX æ£€æµ‹åˆ—è¡¨
			const tvboxIndicators = [
				'okhttp', 'tvbox', 'catvod', 'tang', 'å½±è§†ä»“',
				'androlua', 'lua', 'p2p', 'tv.player', 'tv/',
				'android.tv', 'tvos', 'smarttv', 'fongmi'
			];
			
			// æ£€æµ‹URLå‚æ•°ï¼ˆæœ‰äº›TVBoxé€šè¿‡å‚æ•°æ ‡è¯†ï¼‰
			const urlParams = new URLSearchParams(window.location.search);
			if (urlParams.get('tvbox') || urlParams.get('catvod')) {
				return true;
			}
			
			// ä¸¥æ ¼æ£€æµ‹ï¼šå¿…é¡»åŒ…å« TVBOX ç›¸å…³å…³é”®è¯
			for (let indicator of tvboxIndicators) {
				if (ua.includes(indicator)) {
					console.log('æ£€æµ‹åˆ° TVBOX æ ‡è¯†:', indicator);
					return true;
				}
			}
			
			return false;
		}
		
		// æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
		function showDebugInfo() {
			const debugInfo = `
UserAgent: ${navigator.userAgent}
æ£€æµ‹ç»“æœ: ${isTVBoxUserAgent() ? 'TVBoxå®¢æˆ·ç«¯' : 'æµè§ˆå™¨'}
å®Œæ•´URL: ${window.location.href}
æ—¶é—´: ${new Date().toLocaleString()}
			`.trim();
			
			// åªåœ¨URLæœ‰debugå‚æ•°æ—¶æ˜¾ç¤º
			const urlParams = new URLSearchParams(window.location.search);
			if (urlParams.get('debug')) {
				const debugEl = document.createElement('div');
				debugEl.className = 'device-info';
				debugEl.innerHTML = `<pre style="font-size:10px;text-align:left;white-space:pre-wrap;">${debugInfo}</pre>`;
				document.querySelector('.device-status').after(debugEl);
				
				// æ›´æ–°è®¿é—®æ¨¡å¼æ˜¾ç¤º
				document.getElementById('accessMode').textContent = 
					isTVBoxUserAgent() ? 'TVBoxå®¢æˆ·ç«¯' : 'æµè§ˆå™¨ (è°ƒè¯•æ¨¡å¼)';
			}
			
			console.log('FongMi Debug Info:', debugInfo);
		}
		
		// é»‘è‰²Toastæç¤º
		function showToast(message) {
			const toast = document.createElement('div');
			toast.className = 'toast';
			toast.textContent = message;
			document.body.appendChild(toast);
			
			setTimeout(() => {
				if (toast.parentNode) {
					document.body.removeChild(toast);
				}
			}, 2000);
		}
		
		// å¤åˆ¶åŠŸèƒ½ - ç‚¹å‡»é“¾æ¥å³å¯å¤åˆ¶
		async function copyServiceUrl(element) {
			await copyToClipboard(serviceUrl, 'æ™ºèƒ½æœåŠ¡åœ°å€', element);
		}
		
		async function copyJsonUrl(element) {
			await copyToClipboard(jsonUrl, 'ç›´æ¥æ•°æ®åœ°å€', element);
		}
		
		async function copyToClipboard(text, type, element) {
			try {
				// æ˜¾ç¤ºå¤åˆ¶æˆåŠŸçŠ¶æ€ï¼ˆ3ç§’åæ¶ˆå¤±ï¼‰
				element.classList.add('copied');
				
				if (navigator.clipboard && window.isSecureContext) {
					await navigator.clipboard.writeText(text);
				} else {
					// é™çº§æ–¹æ¡ˆ
					const textArea = document.createElement('textarea');
					textArea.value = text;
					document.body.appendChild(textArea);
					textArea.select();
					document.execCommand('copy');
					document.body.removeChild(textArea);
				}
				
				showToast(`${type}å¤åˆ¶æˆåŠŸï¼\nè¯·åˆ°TVBOXé…ç½®ä¸­ç²˜è´´ä½¿ç”¨`);
				
				// 3ç§’åæ¢å¤åŸå§‹çŠ¶æ€
				setTimeout(() => {
					element.classList.remove('copied');
				}, 3000);
				
			} catch (err) {
				console.error('å¤åˆ¶å¤±è´¥:', err);
				showToast(`${type}å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶åœ°å€`);
				element.classList.remove('copied');
			}
		}
		
		// ä¸‹è½½åº”ç”¨åŠŸèƒ½ - é…ç½®æ‚¨çš„ä¸‹è½½é“¾æ¥
		function downloadApp(type, element) {
			// æ˜¾ç¤ºä¸‹è½½ä¸­çŠ¶æ€ï¼ˆ3ç§’åæ¶ˆå¤±ï¼‰
			element.classList.add('downloading');
			
			// åœ¨è¿™é‡Œé…ç½®æ‚¨çš„GitHubä¸‹è½½é“¾æ¥
			const downloadLinks = {
				'fongmi': 'https://github.com/æ‚¨çš„ç”¨æˆ·å/fongmi-releases/releases',
				'tvbox': 'https://github.com/æ‚¨çš„ç”¨æˆ·å/tvbox-releases/releases'
			};
			
			const url = downloadLinks[type];
			
			if (url && !url.includes('æ‚¨çš„ç”¨æˆ·å')) {
				// æœ‰æœ‰æ•ˆé“¾æ¥ï¼Œç›´æ¥ä¸‹è½½
				setTimeout(() => {
					window.open(url, '_blank');
					// 3ç§’åæ¢å¤åŸå§‹çŠ¶æ€
					setTimeout(() => {
						element.classList.remove('downloading');
					}, 3000);
				}, 500);
			} else {
				// æ²¡æœ‰é…ç½®é“¾æ¥ï¼Œæ˜¾ç¤ºæç¤º
				showToast('è¯¥ç‰ˆæœ¬æ­£åœ¨åŠªåŠ›å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼');
				// 3ç§’åæ¢å¤åŸå§‹çŠ¶æ€
				setTimeout(() => {
					element.classList.remove('downloading');
				}, 3000);
			}
		}
		
		// åˆå§‹åŒ–
		function init() {
			showDebugInfo();
			
			// å¦‚æœæ˜¯TVBOXè®¿é—®ï¼Œç«‹å³é‡å®šå‘åˆ°JSONæ•°æ®
			if (isTVBoxUserAgent()) {
				console.log('TVBOX è®¿é—®æ£€æµ‹åˆ°ï¼Œé‡å®šå‘åˆ° data.json');
				window.location.replace('./data.json');
			}
		}
		
		// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
		document.addEventListener('DOMContentLoaded', init);
	</script>
</body>
</html>